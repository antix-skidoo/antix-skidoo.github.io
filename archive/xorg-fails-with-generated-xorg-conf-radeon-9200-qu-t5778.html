<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
<title>Xorg fails with generated xorg.conf Radeon 9200 Quick fix - antiX oldforums archive</title>
   
<link rel="stylesheet" href="../aaa_style.css">
<script type="text/javascript" src ="../aaa_oldforums.js"></script>
</head>
<body>
<div id="wrap" class="wrap">
<a id="top" class="top-anchor" accesskey="t"></a>

<div id="inner-wrap">
<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks clear-after" role="menubar">
<li class="scroll-breadcrumbs breadcrumbs">
<span class="crumb"><a href="./index.html" accesskey="h" data-navbar-reference="index"><span>antiX - oldforums archive</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./official-releases-f42/index.html"><span>Official releases</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./antix-15-killah-p-f53/index.html"><span>antiX-15 Killah P</span></a></span>
</li>
</ul>

<div id="page-body" class="page-body" role="main">
<div class="postprofile_container postprofile_Left">
<div>
<div class="topictitleheader"><span class="statictopictitle">topic title: </span><span class="topic-titleb"><a href="./xorg-fails-with-generated-xorg-conf-radeon-9200-qu-t5778.html">Xorg fails with generated xorg.conf Radeon 9200 Quick fix</a></div>
<div class="pagination">
6 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>


<div class="viewtopic_wrapper">
<div id="p_42008" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile42008">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 200</span></div>

</div>
</div>
<span class="username">lagopus</span>
</dt>
<dd class="profile-joined">Joined: 15 Oct 2008</dd>
</dl>
<div class="postbody">
<div id="post_content42008">
<time datetime="2015-07-13T17:13">posted: 2015-07-13 &nbsp; 17:13</time>
<span class="permalink"><a href="./xorg-fails-with-generated-xorg-conf-radeon-9200-qu-t5778.html#p42008" title="permalink">#1</a></span>

<div class="content">Booting live from CD, I was stopped at login prompt in console mode.<br>
<br>
<span style="text-decoration: underline">slim.log:</span>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>slim: waiting for X server to begin accepting connections.
..
..
.
Giving up.
slim: unable to connect to X server
</code></pre></div>
<span style="text-decoration: underline">Xorg.0.log:</span>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[   341.023] (==) Log file:"/var/log/Xorg.0.log", Time: Mon Jul 13 02:07:56 2015
[   341.027] (==) Using config file:"/ etc/X11/xorg.conf"
[   341.027] (==) Using config directory:"/ etc/X11/xorg.conf.d"
[   341.027] (==) Using system config directory"/usr/share/X11/xorg.conf.d"
[   341.047] (==) No Layout section.  Using the first Screen section.
...
[   343.205] (II) LoadModule:"sisimedia"
[   343.206] (II) Loading /usr/lib/xorg/modules/drivers/sisimedia_drv.so
[   343.483] (II) Module sisimedia: vendor="X.Org Foundation"
[   343.483]     compiled for 1.16.4, module version = 0.8.0
[   343.483]     Module class: X.Org Video Driver
[   343.483]     ABI class: X.Org Video Driver, version 18.0
[   343.483] (II) SIS: driver for SiS chipsets: SIS5597/5598, SIS530/620,
    SIS6326/AGP/DVD, SIS300/305, SIS630/730, SIS540, SIS315, SIS315H,
    SIS315PRO/E, SIS550, SIS650/M650/651/740,
    SIS[M]661[F|M]X/[M]741[GX]/[M]760[GX]/[M]761[GX]/662, SIS330(Xabre),
    SIS340, [M]670/[M]770[GX], [M]671/[M]771[GX]
[   343.483] (II) SIS: driver for XGI chipsets: Volari Z7 (XG20),
    Volari V3XT/V5/V8/Duo (XG40/XG42)
[   343.483] (++) using VT number 7

[   343.613] (EE) No devices detected.
[   343.613] (EE) 
Fatal server error:
[   343.613] (EE) no screens found(EE) 
[   343.613] (EE) 
</code></pre></div>
<span style="text-decoration: underline">Generated xorg.conf:</span>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>#----------------------------------------------------------------------
# xorg.conf file
#
# Generated by make-xorg-conf sometime around Mon Jul 13 02:02:55 CEST 2015
...
#----------------------------------------------------------------------
Section"Monitor"
    Identifier"Monitor0"
    Option"DPMS""true"
EndSection

Section"Device"
    Identifier"Device0"
    Driver    "sisimedia"
EndSection

Section"Screen"
    Identifier"Screen0"
    Monitor"Monitor0"
    Device "Device0"
    SubSection"Display"
        Modes"1280x1024""1333x768""1024x768""800x600"
    EndSubSection
EndSection</code></pre></div>
<span style="text-decoration: underline">inxi -F<br>
</span>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Graphics: Card: Advanced Micro Devices [AMD/ATI] RV280 [Radeon 9200]
          Display Server: X.org 1.16.4 driver: N/A 
          tty size: 233x60 Advanced Data: N/A for root out of X
</code></pre></div> <br>
<br>
<strong>Quick fix:<br>
</strong><br>
Remove / etc/X11/xorg.conf generated by make-xorg-conf<br>
and from the console, as root:<br>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># slim
</code></pre></div>
after a successful start of Xorg, inxi -F:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Graphics:  Card: Advanced Micro Devices [AMD/ATI] RV280 [Radeon 9200]
           Display Server: X.org 1.16.4 drivers: ati,radeon (unloaded: fbdev,vesa)
           tty size: 172x51 Advanced Data: N/A for root
</code></pre></div></div>
</div>
</div>

</div>
</div>
<div id="p_42013" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile42013">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content42013">

<time datetime="2015-07-13T18:54">posted: 2015-07-13 &nbsp; 18:54</time>
<span class="permalink"><a href="./xorg-fails-with-generated-xorg-conf-radeon-9200-qu-t5778.html#p42013" title="permalink">#2</a></span>

<div class="content">Thanks lagopus! It's good to see you back.<br>
<br>
We added a sisimedia kernel driver from outside the vanilla Linux kernel tree. It does not get loaded automatically by X so for people who have SisS graphics hardware, X was not using their hardware. To get around this, we detect the graphics hardware and if it supports the"sis" or"sis-agp" kernel module then we create an xorg.conf file as per the sisimedia README so people with this hardware boot to X with their graphics hardware supported automatically.<br>
<br>
It appears something has gone wrong on your system but I don't know what. I'd like to see the output of the following command so I can determine what hardware is on your system:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>find /sys/devices -name modalias -print0 | xargs -0 sort -u</code></pre></div>
If you boot the live system in failsafe mode or with the"load=all" cheat then output of that command will be included in the /var/log/live/initrd.log file and you can just attach that (after gzipping it to get past the simple filename filter on this site).<br>
<br>
One possibility is that you have both Radeon and SiS graphics on your machine. It would explain all the symptoms. If that is the case then that has exposed a bug in our code which should be easy to fix. In the meantime, the"noxorg" cheat should prevent an xorg.conf file from being automatically generated. It has been a struggle to maintain OOTB support for older hardware with the newer version of Xorg. There have been a number of special cases to deal with.<br>
<br>
Once I track down and fix the problem, I will make a new initrd.gz available and also an xdelta3 patch for updating the iso file.<br>
<br>
Again, it is great to see you back here. I wish it was under more auspicious circumstances. I appreciate you reporting the problem. Once I sort out what went wrong, I hope you will help us see if the fix works for you.</div>
</div>
</div>

</div>
</div>
<div id="p_42024" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile42024">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 200</span></div>

</div>
</div>
<span class="username">lagopus</span>
</dt>
<dd class="profile-joined">Joined: 15 Oct 2008</dd>
</dl>
<div class="postbody">
<div id="post_content42024">

<time datetime="2015-07-13T22:43">posted: 2015-07-13 &nbsp; 22:43</time>
<span class="permalink"><a href="./xorg-fails-with-generated-xorg-conf-radeon-9200-qu-t5778.html#p42024" title="permalink">#3</a></span>

<div class="content">Thanks BitJam for your kind words.<br>
<br>
I already issued the
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>find /sys/devices -name modalias -print0 | xargs -0 sort -u
</code></pre></div>command I discovered in the init script, but was unable to interpret the cryptic output. <br>
<br>
I'll send you the output tomorrow (not on this system now).<br>
<br>
Indeed this is a desktop I assembled some years ago, with a SiS chipset (sound and video) on the motherboard (AsRock?), and a add on ATI Radeon card. This may be the source of the problem.</div>
</div>
</div>

</div>
</div>
<div id="p_42025" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile42025">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content42025">

<time datetime="2015-07-13T23:33">posted: 2015-07-13 &nbsp; 23:33</time>
<span class="permalink"><a href="./xorg-fails-with-generated-xorg-conf-radeon-9200-qu-t5778.html#p42025" title="permalink">#4</a></span>

<div class="content"><blockquote><div><cite>lagopus wrote:</cite>Indeed this is a desktop I assembled some years ago, with a SiS chipset (sound and video) on the motherboard (AsRock?), and a add on ATI Radeon card. This may be the source of the problem.</div></blockquote>
Ah. That explains it. I don't really need the output now. This is what I was trying to figure out. <br>
<br>
Can you boot via LiveUSB instead of LiveCD? If so I can provide a new initrg.gz file for you to try. Otherwise I can provide an xdelta3 patch that will let you modify the .iso file and burn a new liveCD with the changes. With this approach, it would be help if I knew which iso file you were booting from.<br>
<br>
I'm sorry for the inconvenience. I appreciate your help. I feel we were lucky that you have a SiS hardware combined with other graphics hardware so we could easily find this bug.</div>
</div>
</div>

</div>
</div>
<div id="p_42027" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile42027">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content42027">

<time datetime="2015-07-14T05:46">posted: 2015-07-14 &nbsp; 05:46</time>
<span class="permalink"><a href="./xorg-fails-with-generated-xorg-conf-radeon-9200-qu-t5778.html#p42027" title="permalink">#5</a></span>

<div class="content"><blockquote><div><cite>lagopus wrote:</cite>I already issued the
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>find /sys/devices -name modalias -print0 | xargs -0 sort -u
</code></pre></div>command I discovered in the init script, but was unable to interpret the cryptic output. </div></blockquote>Those are module aliases for the hardware on your system. With another couple of stages of processing you can get the list of modules that are associated with your specific hardware:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code> find /sys/devices -name modalias -print0 | xargs -0 sort -u \
    | xargs modprobe -a -D -q 2&gt;/dev/null | sort -u \
    | sed -n -r"s=^insmod [^ ]*/([^.]*)\.ko.*=\1=p"</code></pre></div>
I ask for the raw modalias output (and record it in initrd.log when"load=all" is used) because this last step depends on which modules are available to the kernel. A modalias line will only be converted to a module name if that module is available. For example, the initrd only has 3.2 Meg of modules while the linuxfs file has 119 Meg. So I have gotten into the habit of requesting the aliases. Also, they require less typing. I should probably add an all-aliases command (or something like that) to the initrd so people can simply type in that command on the live system.<br>
<br>
As I said before, I don't need that output now because you already told me you have SiS graphics hardware on your system.</div>
</div>
</div>

</div>
</div>
<div id="p_42030" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile42030">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 200</span></div>

</div>
</div>
<span class="username">lagopus</span>
</dt>
<dd class="profile-joined">Joined: 15 Oct 2008</dd>
</dl>
<div class="postbody">
<div id="post_content42030">

<time datetime="2015-07-14T13:07">posted: 2015-07-14 &nbsp; 13:07</time>
<span class="permalink"><a href="./xorg-fails-with-generated-xorg-conf-radeon-9200-qu-t5778.html#p42030" title="permalink">#6</a></span>

<div class="content">Just for confirmation, find attached the outputs of:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>find /sys/devices -name modalias</code></pre></div>
and
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>find /sys/devices -name modalias -print0 | xargs -0 sort -u | xargs modprobe -a -D -q</code></pre></div>
Note that the monitor at full resolution is detected at some moment in the init process (output to framebuffer?)
<blockquote class="uncited"><div>Can you boot via LiveUSB instead of LiveCD? If so I can provide a new initrg.gz file for you to try.</div></blockquote>
I prefer a new init file over a patch - (a fix in or near detect_sisimedia_driver()?) <br>
I have yet to test boot from LiveUSB (I forgot how **slow** it is running form LiveCD!)</div>
</div>
</div>

</div>
</div>
</div>
<div class="action-bar bar-bottom">

<div class="pagination">
6 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>
</div>
</div>
</div>
<div class="scrollToTopText"><a href="#top">goto top of page</a></div>

</div>
</body></html>
