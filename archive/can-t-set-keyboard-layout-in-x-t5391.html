<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
<title>Can't set keyboard layout in X - antiX oldforums archive</title>
   
<link rel="stylesheet" href="../aaa_style.css">
<script type="text/javascript" src ="../aaa_oldforums.js"></script>
</head>
<body>
<div id="wrap" class="wrap">
<a id="top" class="top-anchor" accesskey="t"></a>

<div id="inner-wrap">
<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks clear-after" role="menubar">
<li class="scroll-breadcrumbs breadcrumbs">
<span class="crumb"><a href="./index.html" accesskey="h" data-navbar-reference="index"><span>antiX - oldforums archive</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./new-users-f22/index.html"><span>New Users</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./new-users-general-questions-f16/index.html"><span>New Users &amp; General Questions</span></a></span>
</li>
</ul>

<div id="page-body" class="page-body" role="main">
<div class="postprofile_container postprofile_Left">
<div>
<div class="topictitleheader"><span class="statictopictitle">topic title: </span><span class="topic-titleb"><a href="./can-t-set-keyboard-layout-in-x-t5391.html">Can't set keyboard layout in X</a></div>
<div class="pagination">
6 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>


<div class="viewtopic_wrapper">
<div id="p_38270" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile38270">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 8</span></div>

</div>
</div>
<span class="username">dkaparis</span>
</dt>
<dd class="profile-joined">Joined: 22 Nov 2014</dd>
</dl>
<div class="postbody">
<div id="post_content38270">
<time datetime="2014-11-24T20:16">posted: 2014-11-24 &nbsp; 20:16</time>
<span class="permalink"><a href="./can-t-set-keyboard-layout-in-x-t5391.html#p38270" title="permalink">#1</a></span>

<div class="content">Greetings,<br>
<br>
I'm using antiX-13.2-full 64-bit (3.7.10-antix.5-amd64-smp #3 SMP Fri Oct 4 23:41:00 EEST 2013 x86_64 GNU/Linux)<br>
<br>
I've edited the /@etc/default/keyboard file to add more keyboard layouts:<br>
<blockquote class="uncited"><div>
XKBMODEL="pc105"<br>
XKBLAYOUT="us,bg"<br>
XKBVARIANT=""<br>
XKBOPTIONS="grp:alt_shift_toggle,terminate:ctrl_alt_bksp,grp_led:scroll"
</div></blockquote>
However it seems to apply only to the system console (I can use CTRL-ALT-F1 and switch languages there), but not X - the graphical session is fixed to US keyboard layout.<br>
<br>
I can set keyboard configuration successfully with setxkbmap:<br>
<blockquote class="uncited"><div>
setxkbmap -option grp:switch,grp:alt_shift_toggle,grp_led:Â­scroll us,bg
</div></blockquote>
Changing keyboard layout for the session from the Antix Control Center also works.<br>
<br>
Any ideas why /@etc/default/keyboard doesn't work for the X session?<br>
<br>
Thanks,<br>
Dimitri</div>
</div>
</div>

</div>
</div>
<div id="p_38271" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile38271">
<dt class="has-profile-rank has-avatar avatar-username">
<span class="username">anticapitalista</span>
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 5,955</span></div>

</div>
</div>
</dt>
<dd class="profile-rank">Site Admin</dd>
<dd class="profile-joined">Joined: 11 Sep 2007</dd>
</dl>
<div class="postbody">
<div id="post_content38271">

<time datetime="2014-11-24T21:28">posted: 2014-11-24 &nbsp; 21:28</time>
<span class="permalink"><a href="./can-t-set-keyboard-layout-in-x-t5391.html#p38271" title="permalink">#2</a></span>

<div class="content">Did you reboot?</div>
</div>
</div>

</div>
</div>
<div id="p_38278" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile38278">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 8</span></div>

</div>
</div>
<span class="username">dkaparis</span>
</dt>
<dd class="profile-joined">Joined: 22 Nov 2014</dd>
</dl>
<div class="postbody">
<div id="post_content38278">

<time datetime="2014-11-25T08:30">posted: 2014-11-25 &nbsp; 08:30</time>
<span class="permalink"><a href="./can-t-set-keyboard-layout-in-x-t5391.html#p38278" title="permalink">#3</a></span>

<div class="content">Yes, it's consistent across many reboots.</div>
</div>
</div>

</div>
</div>
<div id="p_38352" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile38352">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 8</span></div>

</div>
</div>
<span class="username">dkaparis</span>
</dt>
<dd class="profile-joined">Joined: 22 Nov 2014</dd>
</dl>
<div class="postbody">
<div id="post_content38352">

<time datetime="2014-11-29T12:13">posted: 2014-11-29 &nbsp; 12:13</time>
<span class="permalink"><a href="./can-t-set-keyboard-layout-in-x-t5391.html#p38352" title="permalink">#4</a></span>

<div class="content">Some other things I tried, to no effect:<br>
<br>
In ~/.icewm/startup uncommented the line<br>
<blockquote class="uncited"><div>
setxkbmap -layout"$XKBLAYOUT" -variant"$XKBVARIANT" -option"$XKBOPTIONS"
</div></blockquote>
Also tried with expanded values.<br>
<br>
Added this to /@etc/X11/xorg.conf:<br>
<blockquote class="uncited"><div>
Section"InputClass"<br>
Identifier"system-keyboard"<br>
MatchIsKeyboard"on"<br>
Option"XkbLayout""us,bg"<br>
Option"XkbModel""pc105"<br>
Option"XkbVariant"",bas_phonetic"<br>
Option"XkbOptions""grp:alt_shift_toggle,terminate:ctrl_alt_bksp,grp_led:scroll"<br>
EndSection
</div></blockquote>
Still not switching layouts in the graphical session. It seems the only way to enable it is to manually run the setxkbmap in a terminal after logging in.<br>
<blockquote class="uncited"><div>setxkbmap -layout"us,bg" -variant",bas_phonetic" -option"grp:alt_shift_toggle,terminate:ctrl_alt_bksp,grp_led:scroll"</div></blockquote>
One more observation: if I run the setxkbmap command in the system console instead (with CTRL-ALT-F1), where layout switching already works correctly, I get message:<br>
<blockquote class="uncited"><div>Cannot open display"default display"</div></blockquote>
Any other ideas?</div>
</div>
</div>

</div>
</div>
<div id="p_38353" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile38353">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">

<span> <strong><span class="username">Alanarchy</span></strong> </span>
<div class="thread-user-detail">
<table>
<tr>
<td valign="top" class="detail-title"><a><span>Posts</span></a></td>
<td valign="top" class="detail-value"><span>0</span></td>
</tr>
</table>

</div>
</div>
<section class="desktop-hide">

<strong><span class="username">Alanarchy</span></strong> </section>
</dt>
</dl>
<div class="postbody">
<div id="post_content38353">

<time datetime="2014-11-29T15:46">posted: 2014-11-29 &nbsp; 15:46</time>
<span class="permalink"><a href="./can-t-set-keyboard-layout-in-x-t5391.html#p38353" title="permalink">#5</a></span>

<div class="content">You need to be running the 3.7.10-antix.7-amd64-smp x86_64 Kernel, otherwise you get all kinds of weird errors.<br>
<blockquote class="uncited"><div>12 November 2013<br>
<br>
New bug-fix kernels available<br>
<br>
For those using antiX-13 series with the 3.7.10 kernel, you should update to the latest in the antiX stable repositories. The updated kernel fixes the bug of building applications that need to be built with Wheezy's libs and gcc.<br>
<br>
Without going into detail, if you want to run antiX-13 series fixed to the Wheezy repository and want to install for example Virtualbox and nvidia drivers, you MUST install the latest 3.7.10.antix.7 kernel for your architecture for each application to build. </div></blockquote>

<br>========= SCRAPER REMOVED AN EMBEDDED LINK HERE ===========<br>url was:"http://antix.mepis.org/index.php?title=Main_Page"<br>linktext was:"http://antix.mepis.org/index.php?title=Main_Page"<br>====================================<br>
</div>
</div>
</div>

</div>
</div>
<div id="p_38358" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile38358">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 8</span></div>

</div>
</div>
<span class="username">dkaparis</span>
</dt>
<dd class="profile-joined">Joined: 22 Nov 2014</dd>
</dl>
<div class="postbody">
<div id="post_content38358">

<time datetime="2014-11-30T17:23">posted: 2014-11-30 &nbsp; 17:23</time>
<span class="permalink"><a href="./can-t-set-keyboard-layout-in-x-t5391.html#p38358" title="permalink">#6</a></span>

<div class="content">Thanks for the heads up.<br>
<br>
I completed the procedure for upgrading the kernel, but noticed the update-grub did not change the default boot option and the system was still booting the old kernel. It seems to have added/changed items in the"Debian AUTOMAGIC KERNELS LIST", but the first default option is unchanged, and has to be edited manually to boot the new kernel. Is that expected? If so, maybe the instructions should be augmented..<br>
<br>
Anyway, now keyboard layout switching works only if I add the setxkbmap command to the ~/.icewm/startup file:<br>
<blockquote class="uncited"><div>setxkbmap -layout"us,bg" -variant",bas_phonetic" -option"grp:alt_shift_toggle,terminate:ctrl_alt_bksp,grp_led:scroll"</div></blockquote>
It doesn't work by uncommenting the line that was there (setxkbmap -layout"$XKBLAYOUT" -variant"$XKBVARIANT" -option"$XKBOPTIONS"), I have to expand the values, even though I have set XKBLAYOUT, XKBVARIANT and XKBOPTIONS in the /@etc/default/keyboard file.<br>
<br>
That works for me, but it's strange since I remember setting up antix 13.2 32-bit on another system and there just editing the /@etc/default/keyboard file took full effect including for the graphical session, without need for any other modifications.<br>
<br>
Thanks,<br>
Dimitri</div>
</div>
</div>

</div>
</div>
</div>
<div class="action-bar bar-bottom">

<div class="pagination">
6 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>
</div>
</div>
</div>
<div class="scrollToTopText"><a href="#top">goto top of page</a></div>

</div>
</body></html>
