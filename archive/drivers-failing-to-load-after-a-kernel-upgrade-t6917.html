<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
<title>drivers failing to load after a kernel upgrade - antiX oldforums archive</title>
   
<link rel="stylesheet" href="../aaa_style.css">
<script type="text/javascript" src ="../aaa_oldforums.js"></script>
</head>
<body>
<div id="wrap" class="wrap">
<a id="top" class="top-anchor" accesskey="t"></a>

<div id="inner-wrap">
<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks clear-after" role="menubar">
<li class="scroll-breadcrumbs breadcrumbs">
<span class="crumb"><a href="./index.html" accesskey="h" data-navbar-reference="index"><span>antiX - oldforums archive</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./official-releases-f42/index.html"><span>Official releases</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./antix-16-berta-caceres-f58/index.html"><span>antiX-16 Berta CÃ¡ceres</span></a></span>
</li>
</ul>

<div id="page-body" class="page-body" role="main">
<div class="postprofile_container postprofile_Left">
<div>
<div class="topictitleheader"><span class="statictopictitle">topic title: </span><span class="topic-titleb"><a href="./drivers-failing-to-load-after-a-kernel-upgrade-t6917.html">drivers failing to load after a kernel upgrade</a></div>
<div class="pagination">
1 post
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>


<div class="viewtopic_wrapper">
<div id="p_50885" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile50885">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 2,238</span></div>

</div>
</div>
<span class="username">dolphin_oracle</span>
</dt>
<dd class="profile-joined">Joined: 16 Dec 2007</dd>
</dl>
<div class="postbody">
<div id="post_content50885">
<time datetime="2017-03-27T21:08">posted: 2017-03-27 &nbsp; 21:08</time>
<span class="permalink"><a href="./drivers-failing-to-load-after-a-kernel-upgrade-t6917.html#p50885" title="permalink">#1</a></span>

<div class="content">Sometimes we have to update the kernel, sometimes for security, sometimes for features.<br>
<br>
I recently updated the kernel on a fresh install of antiX 16.1 (security update) and all the dkms drivers were removed. This included the virtual box drivers and the broadcom wl drivers. The broadcom being particularly annoying because I need that one. <span class="emoticon"> __{{emoticon}}__ </span><br>
<br>
Here is a generic script that will force the rebuild of dkms kernel driver modules by reconfiguring their packages. Kinda like a reinstall, without having to download anything.<br>
<br>
This script looks for installed packages with"-dkms" in the name, and runs dpkg-reconfigure on them. Is this perfect, no. but it will work for most of the usual dkms stuff from the debian repos.<br>
<br>
What it won't work on is the nvidia or fglrx drivers installed with smxi. You'll have to fix those on your own (rerunning smxi is a good way to do that).<br>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>#!/bin/bash

#script to rebuild dkms modules installed from deb packages
#dolphin oracle, March 2017
for i in $(dpkg-query -l |grep"\-dkms" |awk '{print $2'}); do
    dpkg-reconfigure $i |tee -a /var/log/rebuild-dkms.log
done
</code></pre></div></div>
</div>
</div>

</div>
</div>

</div>
<div class="action-bar bar-bottom">
<div class="pagination">
1 post
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>
</div>
</div>
</div>
<div class="scrollToTopText"><a href="#top">goto top of page</a></div>

</div>
</body></html>
