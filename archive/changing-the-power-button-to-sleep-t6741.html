<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
<title>Changing the Power Button to Sleep - antiX oldforums archive</title>
   
<link rel="stylesheet" href="../aaa_style.css">
<script type="text/javascript" src ="../aaa_oldforums.js"></script>
</head>
<body>
<div id="wrap" class="wrap">
<a id="top" class="top-anchor" accesskey="t"></a>

<div id="inner-wrap">
<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks clear-after" role="menubar">
<li class="scroll-breadcrumbs breadcrumbs">
<span class="crumb"><a href="./index.html" accesskey="h" data-navbar-reference="index"><span>antiX - oldforums archive</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./official-releases-f42/index.html"><span>Official releases</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./antix-16-berta-caceres-f58/index.html"><span>antiX-16 Berta CÃ¡ceres</span></a></span>
</li>
</ul>

<div id="page-body" class="page-body" role="main">
<div class="postprofile_container postprofile_Left">
<div>
<div class="topictitleheader"><span class="statictopictitle">topic title: </span><span class="topic-titleb"><a href="./changing-the-power-button-to-sleep-t6741.html">Changing the Power Button to Sleep</a></div>
<div class="pagination">
7 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>


<div class="viewtopic_wrapper">
<div id="p_49404" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49404">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 604</span></div>

</div>
</div>
<span class="username">thriftee</span>
</dt>
<dd class="profile-joined">Joined: 27 Feb 2009</dd>
</dl>
<div class="postbody">
<div id="post_content49404">
<time datetime="2016-12-05T00:14">posted: 2016-12-05 &nbsp; 00:14</time>
<span class="permalink"><a href="./changing-the-power-button-to-sleep-t6741.html#p49404" title="permalink">#1</a></span>

<div class="content">I'm running 386 Full with IceWm desktop on laptops, and I've been trying to figure it out how to change the power button to make the system go to sleep or better yet, pop-up the logout menu window, but don't see what happens when the button is pressed to be able to change the action. I also wish I could see the code for the logout menu, but haven't been able to find it.<br>
<br>
I was partially successful changing the / etc/acpi/events/powerbtn-acpi-support action to point to / etc/acpi/sleep_suspend.sh sleep and it does go to sleep, but it goes to xlock and when I type the password, it says it is invalid so it doesn't want to come back when I wake it up.<br>
<br>
Also, when it wakes up the mouse cursor is invisible. This happens when I suspend from the logout menu, too. <br>
<br>
Did I go about this wrong? I just couldn't handle spending 20mb of memory for the xfce power manager just to change the button.<br>
<br>
Any ideas would be appreciated...</div>
</div>
</div>

</div>
</div>
<div id="p_49407" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile49407">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,445</span></div>

</div>
</div>
<span class="username">skidoo</span>
</dt>
<dd class="profile-joined">Joined: 09 Feb 2012</dd>
</dl>
<div class="postbody">
<div id="post_content49407">

<time datetime="2016-12-05T03:02">posted: 2016-12-05 &nbsp; 03:02</time>
<span class="permalink"><a href="./changing-the-power-button-to-sleep-t6741.html#p49407" title="permalink">#2</a></span>

<div class="content">several reputed fixes for"invisible mouse cursor after resume" posted here:<br>

<br>========= SCRAPER REMOVED AN EMBEDDED LINK HERE ===========<br>url was:"https://bugs.launchpad.net/ubuntu/+bug/552214"<br>linktext was:"https://bugs.launchpad.net/ubuntu/+bug/552214"<br>====================================<br>
<br>
<br>
xl</div>
</div>
</div>

</div>
</div>
<div id="p_49408" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49408">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 604</span></div>

</div>
</div>
<span class="username">thriftee</span>
</dt>
<dd class="profile-joined">Joined: 27 Feb 2009</dd>
</dl>
<div class="postbody">
<div id="post_content49408">

<time datetime="2016-12-05T04:42">posted: 2016-12-05 &nbsp; 04:42</time>
<span class="permalink"><a href="./changing-the-power-button-to-sleep-t6741.html#p49408" title="permalink">#3</a></span>

<div class="content">Thanks, skidoo, I didn't find the answer there, per se, but that led me to one which works, at least on my HP so far.<br>
<br>
From: 
<br>========= SCRAPER REMOVED AN EMBEDDED LINK HERE ===========<br>url was:"https://ubuntuforums.org/showthread.php?t=2320013&amp;s=902bd954b63ceb3e8e4cafcf25705403&amp;p=13472993#post13472993"<br>linktext was:"https://ubuntuforums.org/showthread.php ... st13472993"<br>====================================<br>
<br>
<br>
Add a script to /lib/systemd/system-sleep <br>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>#!/bin/bash                                                                                                                                                   
# fix-mouse-cursor.sh - fix invisible cursor after suspend/resume                                                                                             
if ["$1" ="post" ]; then                                                                                                                                    
    modprobe -r psmouse                                                                                                                                       
    modprobe psmouse                                                                                                                                          
fi;                                                                                                                                                           
exit 0
</code></pre></div>
Thanks again... So much for the invisible cursor after suspend/resume bug. <br>
<br>
Any ideas on the power button? I did it again twice today. On my work PC I hit the button to suspend, and again to resume, and I keep doing that by mistake on antiX. On puppy, it popped up a window asking me if I wanted to cancel, suspend or shutdown, so it wasn't a problem there.</div>
</div>
</div>

</div>
</div>
<div id="p_49409" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile49409">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,445</span></div>

</div>
</div>
<span class="username">skidoo</span>
</dt>
<dd class="profile-joined">Joined: 09 Feb 2012</dd>
</dl>
<div class="postbody">
<div id="post_content49409">

<time datetime="2016-12-05T04:55">posted: 2016-12-05 &nbsp; 04:55</time>
<span class="permalink"><a href="./changing-the-power-button-to-sleep-t6741.html#p49409" title="permalink">#4</a></span>

<div class="content">Frankly, I don't use xlock so would just"sudo apt remove xlockmore"</div>
</div>
</div>

</div>
</div>
<div id="p_49410" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49410">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 604</span></div>

</div>
</div>
<span class="username">thriftee</span>
</dt>
<dd class="profile-joined">Joined: 27 Feb 2009</dd>
</dl>
<div class="postbody">
<div id="post_content49410">

<time datetime="2016-12-05T06:17">posted: 2016-12-05 &nbsp; 06:17</time>
<span class="permalink"><a href="./changing-the-power-button-to-sleep-t6741.html#p49410" title="permalink">#5</a></span>

<div class="content">skidoo, yes, You certainly have good ideas. I did that but then had no password to protect the system on resume<br>
<br>
I noticed sucless tools has a program called slock, but unsure how that could be implemented in place of xlockmore.<br>
<br>
I installed xscreensaver (huge) and that fixes the xlockmore issue.<br>
<br>
One issue remains. I suspend,, then i press a key to wake it up, then I need to wait for it to resume and sleep again, then press a key again, and then finally it asks for the password, but at least now it accepts it and resumes, mouse cursor and all. Very odd!<br>
<br>
PS: I deinstalled xscreensaver and am trying xautolock and xtrlock. slock isn't pretty at all as you can't even tell you typed a key or not, etc. I'm not sure that's very important for me, but it wouldn't be a good solution on a distro as a result. Yeah, this is good enough.<br>
<br>
I had to install xautolock and xtrlock<br>
I had to edit desktop-session/startup<br>
added 2 lines to blank the screen and lock it after 20 min:<br>
# setup sceen lock timeout <br>
xautolock -time 25 -locker"xtrlock -b" &amp;<br>
<br>
It still takes 2 tries to resume. I think its doing a 2nd suspend, but don't know why or how to tell it not to. I don't understand that part.<br>
<br>
I don't understand the"dbus" thing at all and wonder if the reason I need to resume twice has something to do with it or the"upower" program which I also don't understand. Maybe one of those is calling the acpi 'ssuspend program more than once? I can see from my debug output that it gets called twice each time I suspend and try to resume.<br>
<br>
I found that the logout option runs desktop-session-exit and that the shutdown and suspend options run:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>                                                                                                                                          
-s|--shutdown)                                                                                                                                              
if [ -e / etc/live/config/save-persist -o -e /live/config/persist-save.conf ] &amp;&amp; which persist-config &amp;&gt; /dev/null; then                             
        sudo persist-config --shutdown --command poweroff                                                                                                   else                                                                                                                                                
        sync                                                                                                                                                    sudo chvt 1                                                                                                                                     
        sudo poweroff                                                                                                                                       fi                                                                                                                                                  
    ;;                                                                                                                                                  -S|--suspend)                                                                                                                                           
    dbus-send --system --print-reply --dest="org.freedesktop.UPower" /org/freedesktop/UPower org.freedesktop.UPower.Suspend                                 ;;                         
 </code></pre></div>
Any ideas why the acpi suspend program gets called again when I try to resume?</div>
</div>
</div>

</div>
</div>
<div id="p_49413" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile49413">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,445</span></div>

</div>
</div>
<span class="username">skidoo</span>
</dt>
<dd class="profile-joined">Joined: 09 Feb 2012</dd>
</dl>
<div class="postbody">
<div id="post_content49413">

<time datetime="2016-12-05T17:30">posted: 2016-12-05 &nbsp; 17:30</time>
<span class="permalink"><a href="./changing-the-power-button-to-sleep-t6741.html#p49413" title="permalink">#6</a></span>

<div class="content">"I think its doing a 2nd suspend, but don't know why or how to tell it not to."<br>
<br>
I'm not convinced"suspend gets called again" during resume. dbus serves as a conduit for interprocess communication.<br>
The"dbus-send" command is just delivering a message to be received by any listeners registered for that (suspend/shutdown) event.<br>
<br>
On the affected machine, check your logfiles for lines mentioning acpi or power -related errors. Also, look in your bios setup screen(s) for mention of"C states" or power management. IIRC, several levels/states exist. _Possibly_, the linux suspend is commanding"low, low, super low" state... but your bios (or your particular CPU) doesn't support that level. Analogy: the first resume command signals"upshift to second gear". Oops your machine's drivetrain only provides low and high gear, so ignores. After timeout, ACPI signals again"upshift to high gear" and that's when machine proceeds with the resume. I've little knowledge of acpi workings; docs might instruct how to config so that a specific Cstate is is requested for suspend event vs powernap vs hibernate...</div>
</div>
</div>

</div>
</div>
<div id="p_49415" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49415">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 604</span></div>

</div>
</div>
<span class="username">thriftee</span>
</dt>
<dd class="profile-joined">Joined: 27 Feb 2009</dd>
</dl>
<div class="postbody">
<div id="post_content49415">

<time datetime="2016-12-05T19:22">posted: 2016-12-05 &nbsp; 19:22</time>
<span class="permalink"><a href="./changing-the-power-button-to-sleep-t6741.html#p49415" title="permalink">#7</a></span>

<div class="content">Thanks for the reply, skidoo. I added and echo to a log file each time the acpi suspend script is called and its timestamped so I can see the 2nd time it ran was 5 minutes later when I tried to resume. I don't know how the suspend script actually gets called though or from where</div>
</div>
</div>

</div>
</div>
</div>
<div class="action-bar bar-bottom">

<div class="pagination">
7 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>
</div>
</div>
</div>
<div class="scrollToTopText"><a href="#top">goto top of page</a></div>

</div>
</body></html>
