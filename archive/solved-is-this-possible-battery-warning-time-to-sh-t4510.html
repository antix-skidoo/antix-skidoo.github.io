<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
<title>[Solved]Is this possible: battery warning; time to shutdown! - antiX oldforums archive</title>
   
<link rel="stylesheet" href="../aaa_style.css">
<script type="text/javascript" src ="../aaa_oldforums.js"></script>
</head>
<body>
<div id="wrap" class="wrap">
<a id="top" class="top-anchor" accesskey="t"></a>

<div id="inner-wrap">
<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks clear-after" role="menubar">
<li class="scroll-breadcrumbs breadcrumbs">
<span class="crumb"><a href="./index.html" accesskey="h" data-navbar-reference="index"><span>antiX - oldforums archive</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./new-users-f22/index.html"><span>New Users</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./new-users-general-questions-f16/index.html"><span>New Users &amp; General Questions</span></a></span>
</li>
</ul>

<div id="page-body" class="page-body" role="main">
<div class="postprofile_container postprofile_Left">
<div>
<div class="topictitleheader"><span class="statictopictitle">topic title: </span><span class="topic-titleb"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html">[Solved]Is this possible: battery warning; time to shutdown!</a></div>
<div class="pagination">
11 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>


<div class="viewtopic_wrapper">
<div id="p_30463" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile30463">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 22</span></div>

</div>
</div>
<span class="username">catch22</span>
</dt>
<dd class="profile-joined">Joined: 07 Jul 2013</dd>
</dl>
<div class="postbody">
<div id="post_content30463">
<time datetime="2013-07-28T19:21">posted: 2013-07-28 &nbsp; 19:21</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p30463" title="permalink">#1</a></span>

<div class="content">I have the battery-% in my conky, but would like to get a warning when on 10% and a second one a bit later, telling me that there'll be an automatic shutdown in 3 minutes.<br>
Is there an easy script for this? <br>
<br>
I've found something that goes in the direction, but there's no first warning and it's for BSD:<br>

<br>========= SCRAPER REMOVED AN EMBEDDED LINK HERE ===========<br>url was:"http://www.unix.com/bsd/115864-battery-empty-force-shutdown.html"<br>linktext was:"http://www.unix.com/bsd/115864-battery- ... tdown.html"<br>====================================<br>
<br>
and also<br>

<br>========= SCRAPER REMOVED AN EMBEDDED LINK HERE ===========<br>url was:"http://forums.freebsd.org/showthread.php?p=34777"<br>linktext was:"http://forums.freebsd.org/showthread.php?p=34777"<br>====================================<br>
</div>
<div class="notice">
Last edited by <b>catch22</b> on 03 Aug 2013, 19:22, edited 1 time in total.
</div>
</div>
</div>

</div>
</div>
<div id="p_30465" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile30465">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,062</span></div>

</div>
</div>
<span class="username">Dave</span>
</dt>
<dd class="profile-joined">Joined: 20 Jan 2010</dd>
</dl>
<div class="postbody">
<div id="post_content30465">

<time datetime="2013-07-28T21:24">posted: 2013-07-28 &nbsp; 21:24</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p30465" title="permalink">#2</a></span>

<div class="content">hmm, I have made conky do this before.... <br>
conky-configuration-t233-30.html?hilit=conky<br>
<br>
maybe my post there will help?</div>
</div>
</div>

</div>
</div>
<div id="p_30541" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile30541">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 22</span></div>

</div>
</div>
<span class="username">catch22</span>
</dt>
<dd class="profile-joined">Joined: 07 Jul 2013</dd>
</dl>
<div class="postbody">
<div id="post_content30541">

<time datetime="2013-08-03T11:29">posted: 2013-08-03 &nbsp; 11:29</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p30541" title="permalink">#3</a></span>

<div class="content"><blockquote><div><cite>Dave wrote:</cite>hmm, I have made conky do this before.... <br>
conky-configuration-t233-30.html?hilit=conky<br>
<br>
maybe my post there will help?</div></blockquote>Thanks Dave. I'll have to wait now till the battery is low, to see if I did it correctly <span class="emoticon"> __{{emoticon}}__ </span> <br>
I'm not shure what I'd have to do with the lowbattery script that is included, but the main part of the conky now looks like this:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>TEXT
${color}antiX
${color}Desktop: ${color}${exec cat ~/.antix-session/desktop-code$DISPLAY}
${color}$sysname $kernel
${color}Uptime: $uptime
${color}${time %a %d %b %k:%M}

${color}Monitors:
${color}cpu: ${color}${cpu}%
${color}ram : ${color}$mem${color}/${color}$memmax ${color}- ${color}$memperc%
${color}swap: ${color}$swap${color}/${color}$swapmax ${color}- ${color}$swapperc%
${color}processes: ${color}$processes  ${color}running: ${color}$running_processes
${color}battery: ${color}$acpiacadapter, ${color yellow}${battery_percent BAT0}% 
${if_existing /sys/class/power_supply/AC/online 0}
${if_match ${battery_percent BAT0} &lt;= 15}${execi 20 notify-send -t 10000 -i /usr/share/icons/gTangish-2.0a1/48x48/status/battery-caution.png"Battery Low""Battery Level is 15%                               Suggesting to save your work, or plug in the computer."}${endif}${endif}
${if_match ${acpitemp} &gt;= 70}${execi 20 notify-send -t 10000 -i /usr/share/icons/gTangish-2.0a1/48x48/status/dialog-warning.png"Tempurature High""Shut Down will occur if Tempurature rises. Suggesting you save your work"}${endif}
${if_existing /sys/class/power_supply/AC/online 0}
${if_match ${battery_percent BAT0} &lt;= 5}${execi 40 lowbattery}${endif}${endif}
${if_match ${acpitemp} &gt;= 75}${execi 40 hightemp}${endif}

${color}Space:
${color}Root:${color} ${fs_free /} ${color}= ${fs_free_perc /}%
${color3}${execi 10 persist-enabled}</code></pre></div></div>
</div>
</div>

</div>
</div>
<div id="p_30543" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile30543">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 146</span></div>

</div>
</div>
<span class="username">Eperbab</span>
</dt>
<dd class="profile-joined">Joined: 10 Dec 2012</dd>
</dl>
<div class="postbody">
<div id="post_content30543">

<time datetime="2013-08-03T13:29">posted: 2013-08-03 &nbsp; 13:29</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p30543" title="permalink">#4</a></span>

<div class="content">You don't have to wait for low battery. Just change {battery_percent BAT0} &lt;= 15} for testing. e.g. &lt;=85. (or actual battery stat -2%) <br>
<span class="emoticon"> __{{emoticon}}__ </span></div>
</div>
</div>

</div>
</div>
<div id="p_30545" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile30545">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,062</span></div>

</div>
</div>
<span class="username">Dave</span>
</dt>
<dd class="profile-joined">Joined: 20 Jan 2010</dd>
</dl>
<div class="postbody">
<div id="post_content30545">

<time datetime="2013-08-03T14:37">posted: 2013-08-03 &nbsp; 14:37</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p30545" title="permalink">#5</a></span>

<div class="content">or make the less than sign a greater than sign. <br>
<br>
however you probably will not receive a notification as notify-send is not installed by default. this would either need to be installed or you can change it to use yad like.....<br>
yad --image="info" --text="warning my battery is getting low. I am currently less than 15 %" --button="gtk-ok:0"<br>
<br>
likewise you can do the same for less than 5 %. on there you could make yad ask to shutdown. so if ok is pressed your computer shutsdown, if cancel is pressed keep running.</div>
</div>
</div>

</div>
</div>
<div id="p_30549" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile30549">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 22</span></div>

</div>
</div>
<span class="username">catch22</span>
</dt>
<dd class="profile-joined">Joined: 07 Jul 2013</dd>
</dl>
<div class="postbody">
<div id="post_content30549">

<time datetime="2013-08-03T19:21">posted: 2013-08-03 &nbsp; 19:21</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p30549" title="permalink">#6</a></span>

<div class="content"><blockquote><div><cite>Dave wrote:</cite>or make the less than sign a greater than sign. <br>
<br>
however you probably will not receive a notification as notify-send is not installed by default. this would either need to be installed or you can change it to use yad like.....<br>
yad --image="info" --text="warning my battery is getting low. I am currently less than 15 %" --button="gtk-ok:0"<br>
<br>
likewise you can do the same for less than 5 %. on there you could make yad ask to shutdown. so if ok is pressed your computer shutsdown, if cancel is pressed keep running.</div></blockquote>Thank you both! That yad-line works fine. I might look up in the man pages how to get the shutdown trick too, but for now I'm happy enough with the warning pop up <span class="emoticon"> __{{emoticon}}__ </span></div>
</div>
</div>

</div>
</div>
<div id="p_32188" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile32188">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 22</span></div>

</div>
</div>
<span class="username">catch22</span>
</dt>
<dd class="profile-joined">Joined: 07 Jul 2013</dd>
</dl>
<div class="postbody">
<div id="post_content32188">

<time datetime="2013-12-07T13:12">posted: 2013-12-07 &nbsp; 13:12</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p32188" title="permalink">#7</a></span>

<div class="content">Minor detail: when the yad-warning starts, it doesn't pop up on top of other programs that are open; can I force it to show on top of everything else?</div>
</div>
</div>

</div>
</div>
<div id="p_32191" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile32191">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,062</span></div>

</div>
</div>
<span class="username">Dave</span>
</dt>
<dd class="profile-joined">Joined: 20 Jan 2010</dd>
</dl>
<div class="postbody">
<div id="post_content32191">

<time datetime="2013-12-07T14:38">posted: 2013-12-07 &nbsp; 14:38</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p32191" title="permalink">#8</a></span>

<div class="content">I think that there is an option in yad called --on-top that should keep the Window on top. Do yad --help or man yad to double check</div>
</div>
</div>

</div>
</div>
<div id="p_32194" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile32194">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 22</span></div>

</div>
</div>
<section class="desktop-hide">

<a href="#" class="username">catch22</a> </section>
</dt>
<dd class="profile-joined">Joined: 07 Jul 2013</dd>
</dl>
<div class="postbody">
<div id="post_content32194">

<time datetime="2013-12-07T17:22">posted: 2013-12-07 &nbsp; 17:22</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p32194" title="permalink">#9</a></span>

<div class="content"><blockquote><div><cite>Dave wrote:</cite>I think that there is an option in yad called --on-top that should keep the Window on top. Do yad --help or man yad to double check</div></blockquote>
Thanks Dave, but I managed to turn my minor issue into a big mess <span class="emoticon"> __{{emoticon}}__ </span> <br>
<br>
I changed the conky-file and here's the relevant part of it:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>${color}battery: ${color}$acpiacadapter, ${color yellow}${battery_percent BAT0}% 
${if_existing /sys/class/power_supply/AC/online 0}
${if_match ${battery_percent BAT0} &lt;= 15}${execi 20 yad --image-on-top="info" --text="WARNING... battery is getting below 15 %" --button="gtk-ok:0"}${endif}${endif}
${if_match ${acpitemp} &gt;= 70}${execi 20 yad --image-on-top="info" --text="Tempurature High - Shut Down will occur if Tempurature rises. Suggesting you save your work"}${endif}${endif}
$</code></pre></div>
Now this conky doesn't show up anymore; BTW it's called"conkyrc_icewm" (without preceeding dot) and is located in a folder called .conky<br>
<br>
When I restart conky it's incomplete - I found this is because there exists another .conkyrc in my home, so I renamed that to .conkyrcNOT to disable it.<br>
Now when I restart conky there's yet another appearance of another one of which I don't even know where it is located <span class="emoticon"> __{{emoticon}}__ </span> <br>
<br>
Sorry for reopening an old solved post and making such a newbee mess of it <span class="emoticon"> __{{emoticon}}__ </span></div>
</div>
</div>

</div>
</div>
<div id="p_32198" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile32198">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,062</span></div>

</div>
</div>
<span class="username">Dave</span>
</dt>
<dd class="profile-joined">Joined: 20 Jan 2010</dd>
</dl>
<div class="postbody">
<div id="post_content32198">

<time datetime="2013-12-07T20:37">posted: 2013-12-07 &nbsp; 20:37</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p32198" title="permalink">#10</a></span>

<div class="content">Oh ok for icewm:<br>
Your startup should have a line similar to:<br>
conky -c ~/.conky/conkyrc_icewm<br>
Similarly when you run conky you need to run it with the -c option just as above. <br>
If you only use icewm, then you can copy the conkyrc_icewm file from ~/.conky to the main home folder ~/ and rename it .conky.<br>
That way you will only need to run"conky" to have your desired config.<br>
<br>
If you have renamed the .conkyrc to try to get conky to look elsewhere it will not, unless you specify the other location with -c. With the ~/.conkyrc file renamed to ~/.conkyrcNOT, then run"conky" it will just use the global config file found at / etc/conky/conky.conf. Clearly this is not what you were looking for.<br>
<br>
To straiten out the battery warning thing. Try using the following code (Using the text portion from above)
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>TEXT
${color}antiX
${color}Desktop: ${color}${exec cat ~/.antix-session/desktop-code$DISPLAY}
${color}$sysname $kernel
${color}Uptime: $uptime
${color}${time %a %d %b %k:%M}

${color}Monitors:
${color}cpu: ${color}${cpu}%
${color}ram : ${color}$mem${color}/${color}$memmax ${color}- ${color}$memperc%
${color}swap: ${color}$swap${color}/${color}$swapmax ${color}- ${color}$swapperc%
${color}processes: ${color}$processes  ${color}running: ${color}$running_processes
${color}battery: ${color}$acpiacadapter, ${battery_percent BAT0}%
${color}${battery_bar BAT0}
${if_existing /sys/class/power_supply/AC/online 0}${if_match ${battery_percent BAT0} &lt;= 15}${execi 5 yad --image="info" --text="Your Battery is Low, sugggesting that you save your work or plug in\!" --button="gtk-ok:0" --on-top --width="300"}${endif}${if_match ${battery_percent BAT0} &lt;= 5}${execi 40  yad --image="info" --text="Battery is at Critical\! $$" --form --field="Shut Down:BTN""""bash -c 'sudo shutdown -h now" --width="300" --button="gtk-cancel:1"}${endif}${endif}
${color}Space:
${color}Root:${color} ${fs_free /} ${color}= ${fs_free_perc /}%
${color3}${execi 10 persist-enabled}
</code></pre></div>
I am guessing that you have received the yad errors before, so I have left the file location the same.<br>
However if there is no error messages, then you will need to change"ls":<br>
/sys/class/power_supply/<br>
There should be a folder there for BAT and AC, Change the BAT0 to match the BAT folder there (in my case BAT1)<br>
BAT0 -&gt; BAT1<br>
and change the ${if_existing /sys/class/power_supply/AC/online 0} to match the AC folder (in my case ACAD)<br>
${if_existing /sys/class/power_supply/AC/online 0} -&gt; ${if_existing /sys/class/power_supply/ACAD/online 0}<br>
<br>
Dave</div>
</div>
</div>

</div>
</div>
<div id="p_32207" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile32207">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 22</span></div>

</div>
</div>
<span class="username">catch22</span>
</dt>
<dd class="profile-joined">Joined: 07 Jul 2013</dd>
</dl>
<div class="postbody">
<div id="post_content32207">

<time datetime="2013-12-08T11:18">posted: 2013-12-08 &nbsp; 11:18</time>
<span class="permalink"><a href="./solved-is-this-possible-battery-warning-time-to-sh-t4510.html#p32207" title="permalink">#11</a></span>

<div class="content">Thanks again Dave!<br>
The conky location is clearer now <span class="emoticon"> __{{emoticon}}__ </span> <br>
<br>
For some reason the pop up appears twice now, with the code as is below, but that's ok; double warning is better than none <span class="emoticon"> __{{emoticon}}__ </span> <br>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>${color}battery: ${color}$acpiacadapter, ${color yellow}${battery_percent BAT0}% 
${color}${battery_bar BAT0}
${if_existing /sys/class/power_supply/AC/online 0}
${if_match ${battery_percent BAT0} &lt;= 15}${execi 5 yad --image="info" --text="WARNING... battery is getting below 15 %" --button="gtk-ok:0" --on-top --width="300"}${endif}
${if_match ${battery_percent BAT0} &lt;= 5}${execi 40 yad --image="info" --text="Battery is at Critical\! $$" --form --field="Shut Down:BTN""""bash -c 'sudo shutdown -h now" --width="300" --button="gtk-cancel:1"}${endif}${endif}
${if_match ${acpitemp} &gt;= 70}${execi 20 yad --image-on-top="info" --text="Tempurature High - Shut Down will occur if Tempurature rises. Suggesting you save your work"}${endif}
${if_existing /sys/class/power_supply/AC/online 0}
${if_match ${battery_percent BAT0} &lt;= 5}${execi 40 lowbattery}${endif}${endif}
${if_match ${acpitemp} &gt;= 75}${execi 40 hightemp}${endif}</code></pre></div></div>
</div>
</div>

</div>
</div>
</div>
<div class="action-bar bar-bottom">

<div class="pagination">
11 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>
</div>
</div>
</div>
<div class="scrollToTopText"><a href="#top">goto top of page</a></div>

</div>
</body></html>
