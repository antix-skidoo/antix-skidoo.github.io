<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
<title>[SOLVED] how to modify the blanking delay ? - antiX oldforums archive</title>
   
<link rel="stylesheet" href="../aaa_style.css">
<script type="text/javascript" src ="../aaa_oldforums.js"></script>
</head>
<body>
<div id="wrap" class="wrap">
<a id="top" class="top-anchor" accesskey="t"></a>

<div id="inner-wrap">
<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks clear-after" role="menubar">
<li class="scroll-breadcrumbs breadcrumbs">
<span class="crumb"><a href="./index.html" accesskey="h" data-navbar-reference="index"><span>antiX - oldforums archive</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./official-releases-f42/index.html"><span>Official releases</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./antix-16-berta-caceres-f58/index.html"><span>antiX-16 Berta Cáceres</span></a></span>
</li>
</ul>

<div id="page-body" class="page-body" role="main">
<div class="postprofile_container postprofile_Left">
<div>
<div class="topictitleheader"><span class="statictopictitle">topic title: </span><span class="topic-titleb"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html">[SOLVED] how to modify the blanking delay ?</a></div>
<div class="pagination">
12 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>


<div class="viewtopic_wrapper">
<div id="p_49096" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49096">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 69</span></div>

</div>
</div>
<span class="username">Ninho</span>
</dt>
<dd class="profile-joined">Joined: 28 Oct 2016</dd>
</dl>
<div class="postbody">
<div id="post_content49096">
<time datetime="2016-11-16T10:06">posted: 2016-11-16 &nbsp; 10:06</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49096" title="permalink">#1</a></span>

<div class="content">Using the applet from Control center, I can't for the salvation of me change the blank screen delay from preconfigured 60 mn <span class="emoticon"> __{{emoticon}}__ </span> Is there a known bug in script, or else what am I missing ? - Alternatively to the graphical applet, I guess the delay could be modified by editing a configuration file... Please help !</div>
<div class="notice">
Last edited by <b>Ninho</b> on 17 Nov 2016, 17:08, edited 1 time in total.
</div>
</div>
</div>

</div>
</div>
<div id="p_49100" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile49100">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 4,164</span></div>

</div>
</div>
<span class="username">rokytnji</span>
</dt>
<dd class="profile-joined">Joined: 20 Feb 2009</dd>
</dl>
<div class="postbody">
<div id="post_content49100">

<time datetime="2016-11-16T14:47">posted: 2016-11-16 &nbsp; 14:47</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49100" title="permalink">#2</a></span>

<div class="content">I set mine in xscreensaver.<br>
<br>

<br>========= SCRAPER REMOVED AN EMBEDDED LINK HERE ===========<br>url was:"https://www.google.com/search?q=screenblanking+site%3Aantix.freeforums.org&amp;ie=utf-8&amp;oe=utf-8"<br>linktext was:"Linky"<br>====================================<br>
<br>
<br>

<br>========= SCRAPER REMOVED AN EMBEDDED LINK HERE ===========<br>url was:"https://www.google.com/search?num=50&amp;q=screen+blanking+site%3Aantix.freeforums.org&amp;oq=screen+blanking+site%3Aantix.freeforums.org&amp;gs_l=serp.12...166813.166813.0.173707.1.1.0.0.0.0.68.68.1.1.0....0...1.1.64.serp..0.0.0.zY7WkLFrwnM"<br>linktext was:"Linky2"<br>====================================<br>
</div>
</div>
</div>

</div>
</div>
<div id="p_49102" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49102">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,445</span></div>

</div>
</div>
<span class="username">skidoo</span>
</dt>
<dd class="profile-joined">Joined: 09 Feb 2012</dd>
</dl>
<div class="postbody">
<div id="post_content49102">

<time datetime="2016-11-16T19:47">posted: 2016-11-16 &nbsp; 19:47</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49102" title="permalink">#3</a></span>

<div class="content">Ninho, it works for me &amp; I can't recall other reports of it not working.<br>
<br>
To investigate"stuffs" launched via controlCentre, you can<br>
<span style="color: green">leafpad /usr/local/bin/antixcc.sh</span><br>
and find in file ("blanking" in this case) which executable is called when you click a given button.<br>
<br>
Here, the command is"set-screen-blank". Most of the commands exposed via controlCentre are shell scripts, so let's check:<br>
<span style="color: green">sudo locate set-screen-blank<br>
leafpad /usr/local/bin/set-screen-blank</span><br>
Notice that the set-screen-blank script writes to this configuration file:<br>
~/.desktop-session/desktop-session.conf<br>
<br>
To test just now, I opened ~/.desktop-session/desktop-session.conf in text editor, scroll to bottom and note the (my) line stating<br>
SCREEN_BLANK_TIME="3600"<br>
then opened controlCentre, clicked the button, changed to"59" minutes, <strong>click"Apply"</strong>, then click"Close".<br>
<br>
Upon revisiting ~/.desktop-session/desktop-session.conf in text editor, I confirmed the setting is successfully changed:<br>
SCREEN_BLANK_TIME="3540"<br>
<br>
I also tested: if you neglect to click the"Apply" button... nope, your change will not be written to the .conf file<br>
<br>
<br>
ps:<br>
xscreensaver isn't installed here &amp; the blanking does still work. It's handled by kernel DPMS.</div>
</div>
</div>

</div>
</div>
<div id="p_49106" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile49106">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 69</span></div>

</div>
</div>
<span class="username">Ninho</span>
</dt>
<dd class="profile-joined">Joined: 28 Oct 2016</dd>
</dl>
<div class="postbody">
<div id="post_content49106">

<time datetime="2016-11-17T11:20">posted: 2016-11-17 &nbsp; 11:20</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49106" title="permalink">#4</a></span>

<div class="content">Thanks for the walkthrough, @Skidoo ! I've manually edited the SCREEN_BLANK_TIME now.<br>
<br>
I'm glad for you that the Control Centre graphical applet works for you, but - as stated in question - it did't for me. At least I could not make sense of how it was supposed to work.
<blockquote class="uncited"><div>... opened controlCentre, clicked the button, changed to"59" minutes, click"Apply", then click"Close".</div></blockquote>
When I click"apply", it will always repeat"screen blanking is off" and offer to turn it on, which opens another instance of the settings dialog, ad nauseam. Oh, well...</div>
</div>
</div>

</div>
</div>
<div id="p_49112" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49112">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 64</span></div>

</div>
</div>
<span class="username">reverseDog</span>
</dt>
<dd class="profile-joined">Joined: 13 Jul 2016</dd>
</dl>
<div class="postbody">
<div id="post_content49112">

<time datetime="2016-11-17T15:44">posted: 2016-11-17 &nbsp; 15:44</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49112" title="permalink">#5</a></span>

<div class="content"><blockquote><div><cite>Ninho wrote:</cite>
When I click"apply", it will always repeat"screen blanking is off" and offer to turn it on, which opens another instance of the settings dialog, ad nauseam. Oh, well...</div></blockquote>
Yeah, I was having exactly the same issue – all these dialogs popping up to no effect. Finally I began to wonder if this was related to my systems locale being German. So in the file <strong>/usr/local/bin/set-screen-blank</strong> I inserted the new line"export LANG=en_US" (after the line"TEXTDOMAIN=set-screen-blank") -- and bingo: now customizing the blanking delay via control center is working just fine.</div>
</div>
</div>

</div>
</div>
<div id="p_49113" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile49113">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 69</span></div>

</div>
</div>
<span class="username">Ninho</span>
</dt>
<dd class="profile-joined">Joined: 28 Oct 2016</dd>
</dl>
<div class="postbody">
<div id="post_content49113">

<time datetime="2016-11-17T17:07">posted: 2016-11-17 &nbsp; 17:07</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49113" title="permalink">#6</a></span>

<div class="content">@ReverseDog : Wow! This is pure genius <span class="emoticon"> __{{emoticon}}__ </span> Works a treat (French locale here).<br>
<br>
It also explains why the developers/testers missed the problem (not enough serious testers on non-English locales, I bet)...<br>
<br>
This should be added to the tricks &amp; tips section if you don't mind - and since it with high probability <em>will</em> work unmodified whatever the locale, including standard US-en, the mod should be considered by maintainers for permanent inclusion in further versions of AntiX, imho.<br>
<br>
Thanks : Marking the case -&gt; closed...</div>
</div>
</div>

</div>
</div>
<div id="p_49114" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49114">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,445</span></div>

</div>
</div>
<span class="username">skidoo</span>
</dt>
<dd class="profile-joined">Joined: 09 Feb 2012</dd>
</dl>
<div class="postbody">
<div id="post_content49114">

<time datetime="2016-11-17T17:32">posted: 2016-11-17 &nbsp; 17:32</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49114" title="permalink">#7</a></span>

<div class="content"><blockquote class="uncited"><div>When I click"apply", it will always repeat"screen blanking is off" and offer to turn it on, which opens another instance of the settings dialog, ad nauseam. </div></blockquote>In my testing, I had not toggled the on/off state.<br>
Doing so now, I notice that <strong>yes</strong> a reproducable bug exists. If not an outright bug, it's confusing.<br>
<br>
A squarish-proportioned dialogbox opens when you click icon in controlCentre.<br>
Not obvious until you hover mouse over it, the [___OFF___] label is a button.<br>
Clicking this"button" raises a second, smaller dialogbox in which you perform the actual"toggle state" operation.<br>
After toggling the state on--}off (or vice versa), second dialogbox closes...<br>
...leaving the original dialogbox, which now (unchanged) incorrectly displays the state.<br>
Yep, loopy<br>
<br>
Well anyhow at least the topic is solved to the extent that you achieved your goal, Ninho.</div>
</div>
</div>

</div>
</div>
<div id="p_49120" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile49120">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 64</span></div>

</div>
</div>
<span class="username">reverseDog</span>
</dt>
<dd class="profile-joined">Joined: 13 Jul 2016</dd>
</dl>
<div class="postbody">
<div id="post_content49120">

<time datetime="2016-11-18T11:26">posted: 2016-11-18 &nbsp; 11:26</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49120" title="permalink">#8</a></span>

<div class="content">Taking a deeper look into the script <strong>/usr/local/bin/set-screen-blank</strong>, I think I finally understand why it fails for certain non-English locales.<br>
<br>
YAD is the culprit. As a matter of fact, with some locales YAD returns a comma for decimal mark instead of a dot. If a French or German antiX user tries to set the screen blank time to, let's say, 45, the value of the variable <strong>TimeScale</strong> (as defined by script lines 82-93) will come out as"|||45,000|". Hence it doesn't get properly cut by the command
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>minutes=$(echo"$TimeScale" |cut -d"|" -f4|cut -d"." -f1);</code></pre></div>
(line 43) which assumes a"." for separator and not a",".<br>
<br>
So it's no wonder that running <strong>set-screen-blank</strong> from terminal (with German locale) and trying to change blanking delay returns the error message
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>$ set-screen-blank
/usr/local/bin/set-screen-blank: Zeile 47: [: 45,000: Ganzzahliger Ausdruck erwartet.</code></pre></div>
(="integer expression expected").<br>
<br>
To avoid this problem I suggest the use of YAD option <strong>--float-precision=0</strong> in forthcoming updates of <strong>set-screen-blank-antix</strong> (lines 82-93):
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code> TimeScale=$(yad --title=$"Screen Blanking" \
    --image="info" \
    --float-precision=0 \ # the added option
    --form \
    --field=$"$DIFFERING_VALUES\nScreen blanking is currently ON.:LBL" \
    --field=$"Turn OFF:BTN""""bash -c 'xset dpms 0 0 0 s 0 0; kill $(pgrep -P $MY_PID); exec $0 &amp; kill $MY_PID'"\
    --field=$"Set the screen blank time.\nValue in minutes:LBL" \
    --field=":NUM""""$SAVED_TIME_M" \
    --width=300 \
    --height=200 \
    --button="gtk-apply:0"  \
    --button="gtk-close:1"  \
    );</code></pre></div>
This way decimal places in YAD output are omitted from the beginning. Setting the screen blank time to 45 will return the value"|||45|" for the variable TimeScale.<br>
<br>
The definition of the variable <strong>minutes</strong> in line 43 can consequently be simplified to
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>minutes=$(echo"$TimeScale" |cut -d"|" -f4);</code></pre></div>
I prefer this solution over the insertion of"export LANG=en_US" I suggested above, because it will preserve the language of YAD's GTK buttons as specified by the user's locale.</div>
</div>
</div>

</div>
</div>
<div id="p_49121" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49121">
<dt class="has-profile-rank has-avatar avatar-username">
<span class="username">anticapitalista</span>
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 5,955</span></div>

</div>
</div>
</dt>
<dd class="profile-rank">Site Admin</dd>
<dd class="profile-joined">Joined: 11 Sep 2007</dd>
</dl>
<div class="postbody">
<div id="post_content49121">
 
<time datetime="2016-11-18T13:57">posted: 2016-11-18 &nbsp; 13:57</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49121" title="permalink">#9</a></span>

<div class="content">Bug fix version should hit the repos soon.<br>
<br>
Thanks for the fix reverseDog</div>
</div>
</div>

</div>
</div>
<div id="p_49216" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile49216">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 69</span></div>

</div>
</div>
<span class="username">Ninho</span>
</dt>
<dd class="profile-joined">Joined: 28 Oct 2016</dd>
</dl>
<div class="postbody">
<div id="post_content49216">

<time datetime="2016-11-25T12:44">posted: 2016-11-25 &nbsp; 12:44</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49216" title="permalink">#10</a></span>

<div class="content">Update: unfortunately the revised, more complicated, version of the script works but <strong>only once</strong> for me :=( I guess there remain one or more subtle language dependencies in the revised script, the debugging of which is evidently much over my head...<br>
Fortunately, rDog's original fix ("export LANG=en_US") works perfectly here. :=)</div>
</div>
</div>

</div>
</div>
<div id="p_49237" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile49237">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 64</span></div>

</div>
</div>
<span class="username">reverseDog</span>
</dt>
<dd class="profile-joined">Joined: 13 Jul 2016</dd>
</dl>
<div class="postbody">
<div id="post_content49237">

<time datetime="2016-11-27T14:26">posted: 2016-11-27 &nbsp; 14:26</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49237" title="permalink">#11</a></span>

<div class="content">Sorry, Ninho, that the revised script won't work for you. To test it with a French locale I just ran"export LANG="fr_FR.utf8"; set-screen-blank" from the terminal and found I was able to change the blanking delay succesfully – not just once, but repeatedly. (Learned the French words"appliquer" and"fermer" on this occasion, my French being very bad, even though the French border is only a few kilometers away from where I live. <span class="emoticon"> __{{emoticon}}__ </span> )<br>
<br>
Could it be that you edited the script manually, and some typo slipped in? Or part of the code got lost in the process of copying? The fix is in the repos by now, so there is no need to edit the script manually in order to test the"more complicated" version.</div>
</div>
</div>

</div>
</div>
<div id="p_49269" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile49269">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 69</span></div>

</div>
</div>
<span class="username">Ninho</span>
</dt>
<dd class="profile-joined">Joined: 28 Oct 2016</dd>
</dl>
<div class="postbody">
<div id="post_content49269">

<time datetime="2016-11-28T18:02">posted: 2016-11-28 &nbsp; 18:02</time>
<span class="permalink"><a href="./solved-how-to-modify-the-blanking-delay-t6698.html#p49269" title="permalink">#12</a></span>

<div class="content">I have upgraded from the Repository - all correkt, now, yeah ! <span class="emoticon"> __{{emoticon}}__ </span>
<blockquote><div><cite>reverseDog wrote:</cite>Could it be that you edited the script manually, and some typo slipped in? Or part of the code got lost in the process of copying?</div></blockquote>
That... quite probably ! Sorry : next time, I'll be sure to save a copy before manually editing system scripts...</div>
</div>
</div>

</div>
</div>
</div>
<div class="action-bar bar-bottom">

<div class="pagination">
12 posts
&bull; Page <strong>1</strong> of <strong>1</strong>
</div>
</div>
</div>
</div>
</div>
<div class="scrollToTopText"><a href="#top">goto top of page</a></div>

</div>
</body></html>
