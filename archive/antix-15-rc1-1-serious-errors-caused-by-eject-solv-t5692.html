<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
<title>antiX-15-rc1.1: Serious errors caused by &quot;eject&quot; [Solved] - antiX oldforums archive</title>
   
<link rel="stylesheet" href="../aaa_style.css">
<script type="text/javascript" src ="../aaa_oldforums.js"></script>
</head>
<body>
<div id="wrap" class="wrap">
<a id="top" class="top-anchor" accesskey="t"></a>

<div id="inner-wrap">
<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks clear-after" role="menubar">
<li class="scroll-breadcrumbs breadcrumbs">
<span class="crumb"><a href="./index.html" accesskey="h" data-navbar-reference="index"><span>antiX - oldforums archive</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./orphaned-posts-f27/index.html"><span>Orphaned Posts</span></a> &raquo;&raquo; </span>

<span class="crumb"><a href="./development-old-f39/index.html"><span>Development (Old)</span></a></span>
</li>
</ul>

<div id="page-body" class="page-body" role="main">
<div class="postprofile_container postprofile_Left">
<div>
<div class="topictitleheader"><span class="statictopictitle">topic title: </span><span class="topic-titleb"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html">antiX-15-rc1.1: Serious errors caused by &quot;eject&quot; [Solved]</a></div>
<div class="pagination">
29 posts
<ul>
<li class="active"><span>1</span></li>
<li><a class="button" href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692-s15.html" role="button">2</a></li>
<li class="arrow next"><a class="button button-icon-only" href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692-s15.html" rel="next" role="button"><span class="sr-only">Next</span></a></li>
</ul>
</div>
</div>

<div class="action-bar bar-top">
</div>
<div class="viewtopic_wrapper">
<div id="p_41485" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile41485">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content41485">
<time datetime="2015-06-28T19:37">posted: 2015-06-28 &nbsp; 19:37</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41485" title="permalink">#1</a></span>

<div class="content">In Virtual Box (version 4.3.28.100309 on Gentoo) any successful use of the"eject" command makes important parts of the system unusable. An easy test is to boot to runlevel 3 with the"toram" option. Then login to a virtual console and run the commands:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>eject -v /dev/sr0
poweroff</code></pre></div>I've attached a screenshot of what happens here.<br>
<br>
I'm <em>hoping</em> this is just an artifact due to Virtual Box or the particular version of Virtual Box I'm using, or my Virtual Box configuration.<br>
<br>
Can anyone else replicate this problem in Virtual Box?<br>
<br>
More importantly: can anyone replicated this problem on real hardware? I don't know if you need to boot from a LiveCD in order to cause the error. You could certainly try to reproduce the error booting from a LiveUSB and running eject and then poweroff.<br>
<br>
Recipe:<ol style="list-style-type: decimal">
<li> Boot using"toram" and"3" (in Virtual Box or with a LiveCD)</li>
<li> Log in as root in a virtual console</li>
<li> Run the commands:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>eject -v /dev/sr0
poweroff</code></pre></div></li></ol>
If the problem only exists in Virtual Box (or in certain versions of Virtual Box) then I can easily work-around it by disabling automatic toram-eject if we detect the system is running on Virtual Box.<br>
<br>
<strong>PS:</strong> I could not replicate the problem with MX-14.4.</div>

<div class="notice">
Last edited by <b>BitJam</b> on 29 Jun 2015, 19:05, edited 2 times in total.
</div>
</div>
</div>

</div>
</div>
<div id="p_41487" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile41487">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 3</span></div>

</div>
</div>
<span class="username">Utopia</span>
</dt>
 <dd class="profile-joined">Joined: 22 Jun 2015</dd>
</dl>
<div class="postbody">
<div id="post_content41487">

<time datetime="2015-06-28T20:20">posted: 2015-06-28 &nbsp; 20:20</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41487" title="permalink">#2</a></span>

<div class="content">Using an USB key, the poweroff command worked on real hardware.<br>
Henry</div>
</div>
</div>

</div>
</div>
<div id="p_41488" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile41488">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content41488">

 <time datetime="2015-06-28T20:25">posted: 2015-06-28 &nbsp; 20:25</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41488" title="permalink">#3</a></span>

<div class="content">Thanks Henry! That's encouraging.</div>
</div>
</div>

</div>
</div>
<div id="p_41489" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile41489">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 2,238</span></div>

</div>
</div>
<span class="username">dolphin_oracle</span>
</dt>
<dd class="profile-joined">Joined: 16 Dec 2007</dd>
</dl>
<div class="postbody">
<div id="post_content41489">

<time datetime="2015-06-28T20:34">posted: 2015-06-28 &nbsp; 20:34</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41489" title="permalink">#4</a></span>

<div class="content">I'm duplicating your error on real hardware (the HP in my sig) running off a 4gb usb stick. No persistence.<br>
<br>
also, after ejecting the usb stick, I could no longer open a terminal window or logout/powerdown from the icewm menu. I resorted to the cli and running sudo poweroff, resulting in the identical input/output error you received.</div>
</div>
</div>

</div>
</div>
<div id="p_41490" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile41490">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 3</span></div>

</div>
</div>
<span class="username">Utopia</span>
</dt>
<dd class="profile-joined">Joined: 22 Jun 2015</dd>
</dl>
<div class="postbody">
<div id="post_content41490">

<time datetime="2015-06-28T20:45">posted: 2015-06-28 &nbsp; 20:45</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41490" title="permalink">#5</a></span>

<div class="content">I'm getting the poweroff error in Virtualbox (using M11). The same error message for the reboot command.<br>
Henry</div>
</div>
</div>

</div>
</div>
<div id="p_41491" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile41491">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content41491">

<time datetime="2015-06-28">posted: 20:50</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41491" title="permalink">#6</a></span>

<div class="content">Thanks D.O.! This is a serious issue IMO since running"eject" borks the system.<br>
<br>
Is anyone able to test and see if the same problem exists on an installed system?<br>
<br>
Also, please check the output of the dmesg command (if your system is not wedged). Something like:<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>dmesg | tail -n50</code></pre></div>should suffice.<br>
<br>
I see nothing in dmesg right after running eject and then I wedged the machine with"poweroff".<br>
<br>
<strong>@D.O.</strong> Does your HP use apm? An easy way to test this is to try to power-off from inside the bootloader using F10 --&gt; poweroff. The reboot works on all/most systems but poweroff only works on older apm systems.<br>
<br>
If it is apm related, I could disable toram-eject on systems that use apm and we could list this as a very big known bug.</div>
</div>
</div>

</div>
</div>
<div id="p_41492" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile41492">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content41492">

<time datetime="2015-06-28T21:09">posted: 2015-06-28 &nbsp; 21:09</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41492" title="permalink">#7</a></span>

<div class="content">I've followed up on the apm angle and I saw that CONFIG_APM is not set in our rc1.1 kernel but it is set in the MX-14.4 kernel which does not have this problem. BUT, I can't even load the apm module inside of Virtual Box (using MX-14.4) so it seems unlikely that the lack of this module is causing the problem.<br>
<br>
ATM the only way I know how to detect apm is to try F10 --&gt; shutdown in the Live bootloader.</div>
</div>
</div>

</div>
</div>
<div id="p_41495" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile41495">
<dt class="has-profile-rank has-avatar avatar-username">
<span class="username">anticapitalista</span>
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 5,955</span></div>

</div>
</div>
</dt>
<dd class="profile-rank">Site Admin</dd>
<dd class="profile-joined">Joined: 11 Sep 2007</dd>
</dl>
<div class="postbody">
<div id="post_content41495">

<time datetime="2015-06-28T21:36">posted: 2015-06-28 &nbsp; 21:36</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41495" title="permalink">#8</a></span>

<div class="content">Bad news. <br>
<br>
Running on real hardware via cd F4 toram option. Same as d_o</div>
</div>
</div>

</div>
</div>
<div id="p_41496" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile41496">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content41496">

<time datetime="2015-06-28T21:42">posted: 2015-06-28 &nbsp; 21:42</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41496" title="permalink">#9</a></span>

<div class="content">Does F10 --&gt; shutdown in the bootloader work?</div>
</div>
</div>

</div>
</div>
<div id="p_41497" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile41497">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 2,238</span></div>

</div>
</div>
<span class="username">dolphin_oracle</span>
</dt>
<dd class="profile-joined">Joined: 16 Dec 2007</dd>
</dl>
<div class="postbody">
<div id="post_content41497">

<time datetime="2015-06-28T22:18">posted: 2015-06-28 &nbsp; 22:18</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41497" title="permalink">#10</a></span>

<div class="content"><blockquote><div><cite>BitJam wrote:</cite>Does F10 --&gt; shutdown in the bootloader work?</div></blockquote>
not on the HP. <br>
<br>
More info:<br>
<br>
I'm having a lot of trouble running apps whenever toram is used and the media is ejected. So far, apps that I've launched prior to ejecting the media still launch, but other apps do not.<br>
<br>
<br>
also tried with acpi=off, and while"halt" worked some of the time with the media ejected, and all the time with the media in place, my machine did not actually poweroff.<br>
<br>
edit ***still more info***<br>
<br>
playing around a little more, and after eject, for instance, I've have never run geany, and if I run geany from the terminal after the media eject, I get the same input/output error BitJam sees for shutdown in his test in the original post. However, apps that I ran before eject (terminal, rox, spacefm, and leafpad) still worked.<br>
<br>
So I'm thinking this is not related to kernel modules (except aufs I guess) but rather in the mechansim be which the linux file system put into ram.<br>
<br>
FWIW, all tests I did were nosavestate, toram, no persistence selected.</div>
</div>
</div>

</div>
</div>
<div id="p_41498" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile41498">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content41498">

<time datetime="2015-06-28T22:58">posted: 2015-06-28 &nbsp; 22:58</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41498" title="permalink">#11</a></span>

<div class="content"><strong>Some Questions</strong>
<ul>
<li> Does the problem exist on installed systems?</li>
<li> Does it exist on systems booted via LiveUSB (when you eject the cd/dvd drive)?</li>
<li> When did the problem start (kernel, antiX version)?</li></ul>
I just tested antiX-14-a3-RV_x64-full with kernel 3.17.0 in Virtual Box and it did not have the problem. Nor did I see the problem in antiX-15-beta1 with the 3.19.1 kernel.</div>
</div>
</div>

</div>
</div>
<div id="p_41500" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile41500">
<dt class="has-profile-rank has-avatar avatar-username">
<span class="username">anticapitalista</span>
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 5,955</span></div>

</div>
</div>
</dt>
<dd class="profile-rank">Site Admin</dd>
<dd class="profile-joined">Joined: 11 Sep 2007</dd>
</dl>
<div class="postbody">
<div id="post_content41500">

<time datetime="2015-06-28T23:06">posted: 2015-06-28 &nbsp; 23:06</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41500" title="permalink">#12</a></span>

<div class="content">Strange - antiX-14-a3-RV_x64-full doesn't work on my box. but antiX-15-beta1 did.</div>
</div>
</div>

</div>
</div>
<div id="p_41501" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile41501">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 1,308</span></div>

</div>
</div>
<span class="username">BitJam</span>
</dt>
<dd class="profile-joined">Joined: 31 Aug 2009</dd>
</dl>
<div class="postbody">
<div id="post_content41501">

<time datetime="2015-06-28T23:10">posted: 2015-06-28 &nbsp; 23:10</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41501" title="permalink">#13</a></span>

<div class="content">antiX-15-beta1 worked but antiX-15-beta2 did not. They both have the same 3.19.1 kernel with identical configurations. This points to a change in the userland tools. Maybe we will get very very lucky and be able to fix this by pinning some packages to older versions.</div>
</div>
</div>

</div>
</div>
<div id="p_41502" class="post has-profile bg1">
<div class="inner">
<dl class="postprofile" id="profile41502">
<dt class="has-profile-rank has-avatar avatar-username">
<span class="username">anticapitalista</span>
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 5,955</span></div>

</div>
</div>
</dt>
<dd class="profile-rank">Site Admin</dd>
<dd class="profile-joined">Joined: 11 Sep 2007</dd>
</dl>
<div class="postbody">
<div id="post_content41502">

<time datetime="2015-06-28T23:15">posted: 2015-06-28 &nbsp; 23:15</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41502" title="permalink">#14</a></span>

<div class="content">antiX-15-beta1 only works when booting to init 3 with toram, login as root, eject -v /dev/sr0, halt<br>
<br>
If I boot to desktop with toram, and choose yes at both eject cd prompts, then try to logout from the menu, it fails</div>
</div>
</div>

</div>
</div>
<div id="p_41504" class="post has-profile bg2">
<div class="inner">
<dl class="postprofile" id="profile41504">
<dt class="no-profile-rank has-avatar avatar-username">
<div class="avatar-username-inner">
<div class="thread-user-detail">
<div class="detail-title-numposts"><span class="detail-title-numposts">Posts: 2,238</span></div>

</div>
</div>
<span class="username">dolphin_oracle</span>
</dt>
<dd class="profile-joined">Joined: 16 Dec 2007</dd>
</dl>
<div class="postbody">
<div id="post_content41504">

<time datetime="2015-06-28T23:21">posted: 2015-06-28 &nbsp; 23:21</time>
<span class="permalink"><a href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692.html#p41504" title="permalink">#15</a></span>

<div class="content"><blockquote><div><cite>BitJam wrote:</cite><strong>Some Questions</strong>
<ul>
<li> Does the problem exist on installed systems?</li>
<li> Does it exist on systems booted via LiveUSB (when you eject the cd/dvd drive)?</li>
<li> When did the problem start (kernel, antiX version)?</li></ul>
I just tested antiX-14-a3-RV_x64-full with kernel 3.17.0 in Virtual Box and it did not have the problem. Nor did I see the problem in antiX-15-beta1 with the 3.19.1 kernel.</div></blockquote>
<blockquote class="uncited"><div>
Does the problem exist on installed systems?</div></blockquote>
No, at least not on mine.<br>
<blockquote class="uncited"><div>Does it exist on systems booted via LiveUSB (when you eject the cd/dvd drive)?</div></blockquote>
not so far as I can tell. I ejected a disk in the drive with the liveusb running, didn't encounter any problems.<br>
<br>
From what I can see, is the stick even still mounted after the linuxfs is loaded to the toram? I see a boot message for"Late umount ...sdb1".<br>
<br>
I can't see where my stick is mounted (/media/sdb1 is not mounted, nor is there a /live/boot-dev <br>
<br>
assuming the stick isn't mounted in the first place, then just pulling the stick is enough to cause the behavior (no eject statement).</div>
</div>
</div>

</div>
</div>
</div>
<div class="action-bar bar-bottom">

<div class="pagination">
29 posts
<ul>
<li class="active"><span>1</span></li>
<li><a class="button" href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692-s15.html" role="button">2</a></li>
<li class="arrow next"><a class="button button-icon-only" href="./antix-15-rc1-1-serious-errors-caused-by-eject-solv-t5692-s15.html" rel="next" role="button"><span class="sr-only">Next</span></a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="scrollToTopText"><a href="#top">goto top of page</a></div>

</div>
</body></html>
